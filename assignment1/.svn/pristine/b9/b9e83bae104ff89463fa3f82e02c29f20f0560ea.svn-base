#!/bin/bash

usage()
{
  echo "Usage: $0 [ -k 'value' ] [ -u ] < [ File ]" 
  exit 2
}

## Initialising variables
cipherShift=0
uppercase=0

## getops for the cipherShift (-k $OPTARG) and uppercase (-u)
while getopts ":k:u" option; do
  case $option in
    (k) cipherShift=$OPTARG;;
    (u) uppercase=1;;
    (*) usage;;
  esac
done
shift $((OPTIND - 1))


if (( uppercase == 1 ))
then
  while read -r line;
  do 
    #prints line   #tr from lower to cap  #tr from cap to the new pattern
    echo ${line} | tr '[a-z]' '[A-Z]' | tr '[A-Z]' $(./create_pattern -k $cipherShift -u)
  done < "${1:-/dev/stdin}";

else
  while read -r line;
  do 
    #prints line   #tr from cap to lower  #tr from cap to the new pattern
    echo ${line} | tr '[A-Z]' '[a-z]' | tr '[a-z]' $(./create_pattern -k $cipherShift)
  done < "${1:-/dev/stdin}";
fi